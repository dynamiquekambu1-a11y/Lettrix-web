<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard ‚Äì Lettrix</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/app.css') }}">
  <style>
    body { font-family: Arial, sans-serif; margin:0; background:#f5f5f5; display:flex; }
    .sidebar { width:220px; background:#2563eb; color:white; min-height:100vh; display:flex; flex-direction:column; }
    .sidebar h2 { text-align:center; padding:20px 10px; margin:0; font-size:20px; border-bottom:1px solid rgba(255,255,255,0.3);}
    .sidebar a { color:white; text-decoration:none; padding:12px 20px; display:block; border-bottom:1px solid rgba(255,255,255,0.1);}
    .sidebar a:hover { background:rgba(255,255,255,0.1);}
    .sidebar .logout { margin-top:auto; background:#1e40af; text-align:center;}
    .main { flex:1; padding:30px; }
    .stats { display:flex; gap:20px; margin-bottom:30px; }
    .card { background:white; padding:15px 20px; border-radius:8px; flex:1; box-shadow:0 2px 6px rgba(0,0,0,0.1); text-align:center;}
    .comments { margin-top:30px; }
    .comment { background:#fff; padding:10px; border-radius:6px; margin-bottom:10px; box-shadow:0 1px 3px rgba(0,0,0,0.05);}
    canvas { background:white; border-radius:8px; padding:10px; }
  </style>
</head>
<body>

<div class="sidebar">
  <h2>LETTRIX</h2>
  <a href="/">üè† Home</a>
  <a href="/admin">üìä Dashboard</a>
  <a href="/comments">üí¨ Comments</a>
  <div class="logout">
    <a href="/logout">üîì Logout</a>
  </div>
</div>

<div class="main">
  <h1>Admin Dashboard</h1>

  <div class="stats">
    <div class="card">
      <h3>Total Comments</h3>
      <p>{{ comments_count }}</p>
    </div>
  </div>

  <h2>Visitors per Day</h2>
  <canvas id="visitsChart" height="120"></canvas>

  <div class="comments">
    <h2>Latest Comments</h2>
    {% for c in comments %}
      <div class="comment">
        <strong>{{ c.name }}</strong> <small>{{ c.created_at }}</small>
        <p>{{ c.message }}</p>
      </div>
    {% else %}
      <p>No comments yet.</p>
    {% endfor %}
  </div>
</div>

<script>
const labels = {{ visits | map(attribute='visit_date') | list | safe }};
const data = {{ visits | map(attribute='count') | list | safe }};

new Chart(document.getElementById('visitsChart'), {
  type: 'line',
  data: {
    labels: labels,
    datasets: [{
      label: 'Visitors per day',
      data: data,
      borderColor: '#2563eb',
      backgroundColor: 'rgba(37,99,235,0.2)',
      borderWidth: 2,
      fill: true,
      tension:0.3
    }]
  },
  options: {
    responsive: true,
    plugins: {
      legend: { display: true, position: 'top' },
      title: { display: true, text: 'Daily Visitors' }
    },
    scales: { y: { beginAtZero:true, stepSize:1 } }
  }
});
</script>

</body>
</html>
